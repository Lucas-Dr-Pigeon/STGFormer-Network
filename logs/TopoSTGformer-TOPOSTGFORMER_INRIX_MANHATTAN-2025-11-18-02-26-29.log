TOPOSTGFORMER_INRIX_MANHATTAN
Trainset:	x-(63051, 1212, 12, 1)	y-(63051, 1212, 12, 1)
Valset:  	x-(21017, 1212, 12, 1)  	y-(21017, 1212, 12, 1)
Testset:	x-(21017, 1212, 12, 1)	y-(21017, 1212, 12, 1)

--------- TopoSTGformer ---------
{
    "num_nodes": 1212,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.6,
    "val_size": 0.2,
    "time_of_day": false,
    "day_of_week": false,
    "lr": 0.001,
    "weight_decay": 0.005,
    "milestones": [
        20,
        40,
        60,
        80,
        100,
        120
    ],
    "warmup_epochs": 3,
    "lr_decay_rate": 0.25,
    "batch_size": 32,
    "max_epochs": 300,
    "early_stop": 30,
    "use_cl": false,
    "cl_step_size": 2500,
    "motifs": [
        "3-stars",
        "4-stars",
        "4-cycles"
    ],
    "model_args": {
        "num_nodes": 1212,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "tod_embedding_dim": 0,
        "dow_embedding_dim": 0,
        "adaptive_embedding_dim": 12,
        "kernel_size": [
            1
        ],
        "num_heads": 4,
        "num_layers": 6,
        "dropout": 0.1,
        "dropout_a": 0.35
    }
}
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
TopoSTGformer                                      [32, 12, 1212, 1]         174,528
├─Linear: 1-1                                      [32, 12, 1212, 24]        48
├─MotifTopoEncoder: 1-2                            [1212, 7]                 --
├─Dropout: 1-3                                     [32, 12, 1212, 12]        --
├─Conv2d: 1-4                                      [32, 36, 1212, 12]        1,332
├─AvgPool2d: 1-5                                   [1212, 1212, 12]          --
├─ModuleList: 1-6                                  --                        --
│    └─SelfAttentionLayer: 2-1                     [32, 12, 1212, 36]        --
│    │    └─GraphPropagate: 3-1                    [32, 12, 1212, 36]        --
│    │    └─ModuleList: 3-4                        --                        (recursive)
│    │    └─ModuleList: 3-5                        --                        (recursive)
│    │    └─ModuleList: 3-4                        --                        (recursive)
│    │    └─ModuleList: 3-5                        --                        (recursive)
│    │    └─Dropout: 3-6                           [32, 12, 1212, 36]        --
│    │    └─LayerNorm: 3-7                         [32, 12, 1212, 36]        72
│    │    └─Mlp: 3-8                               [32, 12, 1212, 36]        5,292
│    │    └─Dropout: 3-9                           [32, 12, 1212, 36]        --
│    │    └─LayerNorm: 3-10                        [32, 12, 1212, 36]        72
├─Linear: 1-7                                      [32, 1212, 36]            15,588
├─ModuleList: 1-8                                  --                        --
│    └─Mlp: 2-2                                    [32, 1212, 36]            --
│    │    └─Linear: 3-11                           [32, 1212, 72]            2,664
│    │    └─ReLU: 3-12                             [32, 1212, 72]            --
│    │    └─Dropout: 3-13                          [32, 1212, 72]            --
│    │    └─Identity: 3-14                         [32, 1212, 72]            --
│    │    └─Linear: 3-15                           [32, 1212, 36]            2,628
│    │    └─Dropout: 3-16                          [32, 1212, 36]            --
│    └─Mlp: 2-3                                    [32, 1212, 36]            --
│    │    └─Linear: 3-17                           [32, 1212, 72]            2,664
│    │    └─ReLU: 3-18                             [32, 1212, 72]            --
│    │    └─Dropout: 3-19                          [32, 1212, 72]            --
│    │    └─Identity: 3-20                         [32, 1212, 72]            --
│    │    └─Linear: 3-21                           [32, 1212, 36]            2,628
│    │    └─Dropout: 3-22                          [32, 1212, 36]            --
│    └─Mlp: 2-4                                    [32, 1212, 36]            --
│    │    └─Linear: 3-23                           [32, 1212, 72]            2,664
│    │    └─ReLU: 3-24                             [32, 1212, 72]            --
│    │    └─Dropout: 3-25                          [32, 1212, 72]            --
│    │    └─Identity: 3-26                         [32, 1212, 72]            --
│    │    └─Linear: 3-27                           [32, 1212, 36]            2,628
│    │    └─Dropout: 3-28                          [32, 1212, 36]            --
│    └─Mlp: 2-5                                    [32, 1212, 36]            --
│    │    └─Linear: 3-29                           [32, 1212, 72]            2,664
│    │    └─ReLU: 3-30                             [32, 1212, 72]            --
│    │    └─Dropout: 3-31                          [32, 1212, 72]            --
│    │    └─Identity: 3-32                         [32, 1212, 72]            --
│    │    └─Linear: 3-33                           [32, 1212, 36]            2,628
│    │    └─Dropout: 3-34                          [32, 1212, 36]            --
│    └─Mlp: 2-6                                    [32, 1212, 36]            --
│    │    └─Linear: 3-35                           [32, 1212, 72]            2,664
│    │    └─ReLU: 3-36                             [32, 1212, 72]            --
│    │    └─Dropout: 3-37                          [32, 1212, 72]            --
│    │    └─Identity: 3-38                         [32, 1212, 72]            --
│    │    └─Linear: 3-39                           [32, 1212, 36]            2,628
│    │    └─Dropout: 3-40                          [32, 1212, 36]            --
│    └─Mlp: 2-7                                    [32, 1212, 36]            --
│    │    └─Linear: 3-41                           [32, 1212, 72]            2,664
│    │    └─ReLU: 3-42                             [32, 1212, 72]            --
│    │    └─Dropout: 3-43                          [32, 1212, 72]            --
│    │    └─Identity: 3-44                         [32, 1212, 72]            --
│    │    └─Linear: 3-45                           [32, 1212, 36]            2,628
│    │    └─Dropout: 3-46                          [32, 1212, 36]            --
├─Linear: 1-9                                      [32, 1212, 12]            444
====================================================================================================
Total params: 246,194
Trainable params: 246,194
Non-trainable params: 0
Total mult-adds (Units.MEGABYTES): 630.38
====================================================================================================
Input size (MB): 1.86
Forward/backward pass size (MB): 2986.06
Params size (MB): 0.29
Estimated Total Size (MB): 2988.21
====================================================================================================

Loss: MaskedMAELoss

